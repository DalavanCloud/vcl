ASF VCL 2.2

Dependency changes:

Web frontend:
No dependency changes

database:
- none

backend vcld:
No dependency changes

Release Notes - VCL - Version 2.2

** Bug
    * [VCL-121] - special characters in API passwords not handled correctly
    * [VCL-150] - Pages do not display correctly with IE8
    * [VCL-154] - run_scp_command() is not catching permission denied errors
    * [VCL-158] - utils.pm setstaticaddress() does not work correctly for Windows
    * [VCL-159] - xCAT.pm is not always waiting long enough for ssh to respond on load
    * [VCL-160] - Sysprep is overwriting DevicePath key after spdrvscn.exe runs
    * [VCL-165] - Fix syntax bugs cause reservation processes to die
    * [VCL-181] - VCL desktop request tool - use API to make reservations
    * [VCL-189] - cannot add a computer in maintenance state
    * [VCL-193] - IP address field not large enough for 15-characters
    * [VCL-194] - Marking new computer to be "maintenance" status causes indexing error
    * [VCL-197] - _is_user_added routine 
    * [VCL-210] - getdynamicaddress returns 127.0.01 for missing public adapter
    * [VCL-214] - Windows modules don't always disable autoadminlogon
    * [VCL-215] - reservation_failed sub in State.pm may change state of computer currently in maintenance
    * [VCL-220] - VMs in the available state which aren't assigned to a VM host may be reserved
    * [VCL-221] - Add check to make sure post_load tasks have run before reserving a computer
    * [VCL-227] - deleting user group that owns a resource group
    * [VCL-233] - all calls to simpleAddRequest need to check for all return codes
    * [VCL-241] - detailed loading summary does not compute times correctly for future reservations that are preloaded
    * [VCL-242] - currentimage.txt permissions incorrect set
    * [VCL-245] - esx.pm - always reloads 
    * [VCL-250] - authentication for XML RPC X-User doesn't properly check to see if no authtype was found
    * [VCL-258] - cluster loads - cluster_info file
    * [VCL-260] - Problems occur if root is not the owner of /home/root for Windows images
    * [VCL-261] - Windows.pm filesystem_entry_exists() subroutine may return true even if output contains "file not found"
    * [VCL-262] - Windows capture may remove "Log on as a service" right for existing accounts
    * [VCL-265] - Linux adduser cmd - remove uid parameter if uid not defined in user table 
    * [VCL-266] - New process detects another reload process being complete before it should
    * [VCL-267] - cluster loads  listing wrong parent and child addresses cluster_info file
    * [VCL-269] - Windows.pm logoff_users() does not detect disconnected users
    * [VCL-273] - Single quotes in image pretty name can cause image capture to fail
    * [VCL-299] - shib users may have incorrect full name and email address.
    * [VCL-300] - shib users always have email notices turned off
    * [VCL-303] - tomaintenance reservations inserting wrong image revision
    * [VCL-306] - Web GUI code has hard coded Eastern Time Zone information - breaks in other time zones
    * [VCL-307] - add empty post_reserve routine UnixLab.pm OS module
    * [VCL-317] - scheduler doesn't take imagerevision into account
    * [VCL-318] - API error if invalid affiliation is used
    * [VCL-325] - removing a subimage from a cluster can result in all subimages getting removed
    * [VCL-327] - set_computer_name.vbs causes Sysprep to hang if certain applications are installed
    * [VCL-329] - DataStructure.pm get_computer_private_ip_address() not handling all valid formats in /etc/hosts
    * [VCL-331] - Windows code does not handle special characters in Scheduled Task names when changing passwords
    * [VCL-332] - cannot delete block requests once the start date has passed
    * [VCL-333] - DataStructure %ENV hash not get detected in _initialize routine 
    * [VCL-334] - numeric userids are not handled correctly
    * [VCL-337] - Windows.pm delete_files_by_pattern may delete unintended files if an environment variable isn't defined
    * [VCL-338] - vmprofiles that are in use can be deleted
    * [VCL-340] - cannot change name of vmprofile
    * [VCL-346] - getdynamicaddress routine regex issue
    * [VCL-347] - cluster connect page rdp file
    * [VCL-349] - sql insert queries for image and imagerevision tables
    * [VCL-353] - vmware.pm inserting new images - if original name is not in proper format $oldname does not get set correctly.
    * [VCL-356] - vmware esx pm - vmware image directories
    * [VCL-362] - vmware.pm power command output not detected under ESX 3.5
    * [VCL-363] - Passwords for existing Linux accounts are reset when the root password is set
    * [VCL-364] - vmhostid removed when vm put in maintenance state
    * [VCL-368] - pre-capture and post load linux steps correct sed cmd line options
    * [VCL-370] - Reservation ID not defined errors occur for cluster reservations
    * [VCL-371] - Private IP address is not being found in /etc/hosts under some circumstances
    * [VCL-377] - multiple clicks on Create Reservation button gives multiple reservations
    * [VCL-378] - reservation can be extended into a block allocation for user not in block group
    * [VCL-382] - vmware.pm incorrectly handles free server with network datastores
    * [VCL-386] - older vmware.pm module not removing vmhostid from vm

** Improvement
    * [VCL-2] - migrate preferredimage to nextimage
    * [VCL-9] - Update reclaim.pm to use DataStructure methods
    * [VCL-11] - Update blockrequest.pm to use database subroutines
    * [VCL-31] - rename conf.php and secrets.php to include -default in the name
    * [VCL-32] - modify XMLRPCaddRequest to allow an end time to be specified
    * [VCL-93] - LDAP part of a login to fail silently on errors when Shibboleth authentication is used
    * [VCL-94] - Rework image capture flow
    * [VCL-98] - upgrade all of dojo-0.4.0 code to recent version of dojo
    * [VCL-125] - Add ability to control whether or not users have root/administrator access
    * [VCL-137] - Update vmware.pm to use provisioning module interface subroutine names
    * [VCL-145] - Store product keys in the database
    * [VCL-148] - Add management node to current reservations view for ADMIN_DEVELOPER
    * [VCL-149] - Prevent multiple vcld processes
    * [VCL-153] - Update interface subroutines in xCAT21.pm to match xCAT.pm
    * [VCL-155] - Decrease initial Current Reservation page refresh interval
    * [VCL-161] - remove  xmlrpcKey table from vcl.sql 
    * [VCL-162] - create structure to add throttling to provisioning modules
    * [VCL-163] - move throttle variable from vcld.conf to managment node table
    * [VCL-164] - Make installation and configuration easier
    * [VCL-200] - add edit node name option in Privilege tree
    * [VCL-204] - remove private ssh identity keys from known locations- post load / pre-capture routines
    * [VCL-206] - Alphabetize list of virtual hosts
    * [VCL-211] - image creation mode - administrator timeout
    * [VCL-223] - Remove information user should not be able to access on post_load
    * [VCL-224] - Move settings from vcld.conf to database except for database connection settings
    * [VCL-244] - Staticics page - show number of failed loads per image
    * [VCL-248] - Update provisioning modules' node_status to return READY if SSH works but ping doesn't
    * [VCL-251] - Make "Later" reservation time default to a time in the future.
    * [VCL-252] - XMLHttpTransport Error
    * [VCL-254] - block request improvements
    * [VCL-255] - xmlrpc_call routine add better error control
    * [VCL-271] - clean out unused routines
    * [VCL-272] - block request form
    * [VCL-275] - Predictive reloading level_1 module
    * [VCL-284] - vmware.pm power_reset sub does not catch error if VMware tools are not running
    * [VCL-286] - post_linux load operation - set hostname that matches public IP address
    * [VCL-288] - Add Global affiliation to schema
    * [VCL-293] - check for remote ldap server being up before connecting to it
    * [VCL-295] - Combine normal new reservation and imaging new reservation code
    * [VCL-302] - provide feedback to users about block reservation status
    * [VCL-305] - update code to work with php 5.3
    * [VCL-314] - change Documentation link to have links to ASF docs
    * [VCL-320] - random selection of computer for reservations
    * [VCL-326] - Shutdown Event Tracker causes autologin to fail
    * [VCL-335] - max allowed ram for computers needs to be increased
    * [VCL-357] - create update sql script to upgrade to the latest schema
    * [VCL-359] - Remove DHCP and static IP configuration sections from provisioning modules

** New Feature
    * [VCL-134] - Add ability to control whether or not users have root/administrator access
    * [VCL-142] - Add KMS activation server configuration per affiliation
    * [VCL-146] - add linux support for all VMWare modules
    * [VCL-180] - add power_X(off,on,reset,status)  routines to provisioning modules 
    * [VCL-182] - Linux virtual machine support
    * [VCL-195] - Add support for Windows Server 2008
    * [VCL-196] - Add support for 64-bit Windows
    * [VCL-201] - Add support for Windows Vista VMware images
    * [VCL-208] - Ability to easily put the VCL site into a maintenance state to prevent user access
    * [VCL-239] - xcat 2.X module
    * [VCL-268] - OS table - create additional OS ids
    * [VCL-278] - Add setup mechanism to vcld
    * [VCL-279] - Add post_load_custom script functionality for Linux images
    * [VCL-292] - option to save selected authentication method in cookie
    * [VCL-294] - create a login log
    * [VCL-298] - Add support for VMware Server 2.x and ESXi 4.x
    * [VCL-301] - Add support for Windows 7
    * [VCL-351] - extend vm profile to have more virtualswitches
    * [VCL-352] - Add additional pre-capture steps for Linux OS
    * [VCL-365] - change select box for environment on new reservation page to dojo filteringselect

** Task
    * [VCL-138] - remove antiquated vcldquery support
    * [VCL-139] - make users' names optional
    * [VCL-274] - check for SQL injection / XSS

====================================================================================================
ASF VCL 2.1

Dependency changes:

web frontend:
-no testing with PHP 4 was done. VCL may work under PHP 4, but PHP 5 was assumed during development.

database:
none

backend:
Perl modules
- Class-Data-Inheritable-0.08
- Devel-StackTrace-1.20
- Exception-Class-1.26
- Object-InsideOut-3.52
- Module-Build-0.30
- XML-Stream-1.22
- YAML-0.68
- RPC-XML-0.64
- XML-Parser-2.36
- Crypt-SSLeay-0.57
- Compress-Raw-Zlib-2.020
- IO-Compress-2.020
- libwww-perl-5.827
- HTTP-Headers


Bug/Feature issues exported from JIRA

** Sub-task
    * [VCL-67] - Allow OS, provisioning engine, and other module objects to access each other

** Bug
    * [VCL-14] - xCAT.pm's capture_monitor output always displays "attempt 1/80"
    * [VCL-26] - get_reservation_remote_ip subroutine redefined warning
    * [VCL-34] - When adding computers, missing requirement for the provisioning module 
    * [VCL-51] - user groups that have a name that is a number cause problems on the privilege page
    * [VCL-54] - disable LDAP referrals for all LDAP connections to handle firewalls
    * [VCL-55] - processBulkComputerInput in computers.php not always setting startpripaddress, endpripaddress, startmac
    * [VCL-61] - blockrequest and the reload state
    * [VCL-62] - Calls to _rpower in Windows.pm cause reservation processes to die
    * [VCL-64] - EmptyRecycleBin.exe utility causes problems during image capture
    * [VCL-69] - Unknown column 'af.shibonly' in 'field list'
    * [VCL-71] - Reservation processes being killed unexpectedly
    * [VCL-73] - new.pm::computer_not_being_used hangs occasionally
    * [VCL-74] - Reservation may fail if user's UID value is null
    * [VCL-75] - Bug in Perl 5.8.0 causes exit status to be reported incorrectly
    * [VCL-76] - form tags outside of td tags on Edit Image Profiles page
    * [VCL-79] - error in how the end time for schedule times is computed
    * [VCL-81] - Image retrieval does not verify if it was successful
    * [VCL-85] - watchInFlight error appears if image description contains special characters
    * [VCL-88] - vclreload account assumed to match the default affiliation
    * [VCL-90] - Image reservation for sub-image with "nousercheckout" flag set
    * [VCL-91] - edit reservation allows saving/updaing image for cluster reservations
    * [VCL-96] - < and > in user's passwords not handled properly
    * [VCL-101] - forimaging flag causes wrong user when imaging linux in reserved.pm
    * [VCL-103] - vclreload account has invalid curiculumid
    * [VCL-108] - apostrophe in image name causes AJAX updates to privilege page to break
    * [VCL-109] - viewing requests from timetable not using continuations
    * [VCL-111] - missing default values for vmtype table
    * [VCL-119] - Reservations insert log.ending = EOR when they shouldn't
    * [VCL-126] - get_new_dbh() doesn't return correct value if different database is specified
    * [VCL-129] - LockerWrtUser doesn't work with usernames containing underscores
    * [VCL-131] - utils getdynamicaddress routine - bad regex
    * [VCL-136] - missing perlpackage for id 6 in module table
    * [VCL-143] - need to drop allowing new reservations to take priority over reload reservations
    * [VCL-151] - apostrophe in last name can cause an error when adding user to database
    * [VCL-166] - Windows firewall subs not catching "Object already exists" in netsh.exe output
    * [VCL-167] - run_ssh_command not catching host key differs warning messages
    * [VCL-172] - xCAT21.pm - xcat database is locked at dbdimp.c error
    * [VCL-186] - Windows images losing default gateway
    * [VCL-187] - Ubuntu.pm - not  completed
    * [VCL-191] - path changes in vshpere SDK vmware perl toolkit
    * [VCL-207] - Predictive reload modules not accounting for machines in block computers table
    * [VCL-213] - Bug in retrieve_image sub in vmware.pm and xCAT.pm calls next instead of return
    * [VCL-218] - vmware.pm may delete image being captured by cleanup process
    * [VCL-226] - Windows reboot fails - processing another action error
    * [VCL-238] - Linux.pm  pre-capture routine not shuting down OS
    * [VCL-240] - utils.pm - insert_reload_request
    * [VCL-246] - READY flag check for VMware and xCAT is being thrown off by other processes running on machines
    * [VCL-247] - computer with shortname  only in database not being reloaded after being used
    * [VCL-263] - Linux.pm - add default vcl user group

** Improvement
    * [VCL-3] - clean up database
    * [VCL-6] - update healthcheck.pl to use modularized code
    * [VCL-15] - modify blockrequest module to use frontend API for scheduling
    * [VCL-20] - Configuration of sshd port for image retrieval
    * [VCL-23] - Modularize Windows OS code
    * [VCL-63] - Remove critical notification if image is configured with a user group containing 0 members
    * [VCL-65] - Remove pagefile from all drives during image capture
    * [VCL-72] - die and warning signals are not handled by the backend code
    * [VCL-84] - Prevent users from starting create image until computer is in inuse state
    * [VCL-105] - an image cannot have itself as a subimage
    * [VCL-106] - mail notifications notify routine
    * [VCL-107] - User email notifications
    * [VCL-110] - 2 second deley in vcld may cause problems with imaging
    * [VCL-112] - Provide access to image affiliation data via DataStructure.pm
    * [VCL-115] - allow user groups with the same name but different affiliations
    * [VCL-118] - Add delay to run_ssh_command() & run_scp_command() retry attempts
    * [VCL-120] - Add subroutine to set IE's runonce registry keys so user isn't presented with it
    * [VCL-124] - locally affiliated users need a way to change their password
    * [VCL-128] - Update reclaim.pm
    * [VCL-132] - vcld check_time 
    * [VCL-156] - insert current_image.txt file on kickstart based nodes
    * [VCL-157] - Add support for xCAT 2.1 partimage format
    * [VCL-173] - add power_off,power_on,power_reset,power_status routines to xCAT21 module
    * [VCL-175] - Set virtual switch 0 from database value for VMware GSX
    * [VCL-176] - Prevent vmware.pm from looping 15 times before checking ssh during load
    * [VCL-177] - Remove Windows OS post-load configuration tasks from vmware.pm
    * [VCL-183] - DataStructure.pm contains duplicate subroutines: get_computer_private_ip and get_computer_private_ip_address
    * [VCL-184] - Update database schema for 2.1 release
    * [VCL-185] - Modularize Linux OS Code
    * [VCL-188] - Document Windows tools dependencies
    * [VCL-190] - Add time configuration and synchronization commands to Windows post_load
    * [VCL-205] - allow esx provisioing module to set MAC addresses
    * [VCL-212] - Add code to set SysprepStatus registry keys for Windows 6
    * [VCL-217] - xcat modules - Throttle control
    * [VCL-228] - Windows image capture fails to delete user profiles because file is open

** New Feature
    * [VCL-1] - xCAT 2.0 module
    * [VCL-4] - add support for Shibboleth authentication
    * [VCL-7] - modify healthcheck.pl to monitor vms
    * [VCL-18] - allow dynamic change of predictive loading module
    * [VCL-19] - add configuration of v2 fields for management nodes
    * [VCL-21] - add check for existance of image libraries
    * [VCL-29] - author an ESX and ESX 3i provisioning module (using netboot)
    * [VCL-33] - add user group management to XML RPC API
    * [VCL-78] - API for backend to allocate computers for block reservations via the frontend
    * [VCL-123] - add Ubuntu Support using the new OS Module framework
    * [VCL-209] - create a page that will test for required php modules and correct configuration

** Task
    * [VCL-70] - Create a basic helloworld.pm provisioning module
    * [VCL-95] - Set Subversion properties for files in repository
    * [VCL-135] - remove all references to ncsu
    * [VCL-198] - Release tasks
    * [VCL-264] - VCL 2.1 RC2 todo items
